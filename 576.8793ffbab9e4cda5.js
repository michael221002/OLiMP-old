"use strict";(self.webpackChunkangularapp=self.webpackChunkangularapp||[]).push([[576],{7576:(L,f,s)=>{s.r(f),s.d(f,{InitializeModule:()=>O});var M=s(6814),p=s(6223),I=s(1274),E=s(2296),r=(s(2831),s(5879));let F=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({}),t})();var v=s(3680),_=s(9157);let b=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[v.BQ,_.lN,_.lN,F,v.BQ]}),t})();var S=s(5313),R=s(830),T=s(2939),w=s(1896),H=s(9315),z=s(5619),k=s(5592),g=s(1486),x=s(555);let N=(()=>{class t{constructor(e){this.appData=e,this.initializeFiles=new z.X([])}newFileImport(e){this.initializeFiles.next([]);const i=new FileReader;return new k.y(o=>{i.onload=a=>{const c=g.ij(a.target.result,{type:"binary"}),d=g.P6.sheet_to_json(c.Sheets[c.SheetNames[0]],{defval:""});for(const u of d)u.employeenumber=Number(u.employeenumber),u.manager_employee_number=Number(u.manager_employee_number),u.is_employed=Number(u.is_employed);const m={jsonData:d,displayedColumns:d.length>0?Object.keys(d[0]):[],fileName:e.name};this.initializeFiles.next([...this.initializeFiles.value,m]),o.next(m),o.complete()},i.onerror=a=>{o.error(a)},i.readAsBinaryString(e)})}getInitializeFiles(){return this.initializeFiles.asObservable()}}return t.\u0275fac=function(e){return new(e||t)(r.LFG(x.U))},t.\u0275prov=r.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const D=[{path:"",component:(()=>{class t{constructor(e,i){this.initializeService=e,this.appData=i}ngOnInit(){}onFilesSelected(e){this.appData.setSpinner(!0),console.log("onFilesSelected called");const i=e.target;if(i.files){const a=Array.from(i.files).map(l=>this.initializeService.newFileImport(l));(0,H.D)(a).subscribe(l=>{console.log(l),this.appData.openSnackbar("Files imported successfully","okay"),this.appData.setSpinner(!1)},l=>{console.error("Error importing files:",l),this.appData.openSnackbar(`There went something wrong ${l}`,"okay"),this.appData.setSpinner(!1)})}}}return t.\u0275fac=function(e){return new(e||t)(r.Y36(N),r.Y36(x.U))},t.\u0275cmp=r.Xpm({type:t,selectors:[["app-initialize"]],decls:3,vars:0,consts:[[1,"main"],["type","file","multiple","",3,"change"]],template:function(e,i){1&e&&(r.TgZ(0,"div",0)(1,"div")(2,"input",1),r.NdJ("change",function(a){return i.onFilesSelected(a)}),r.qZA()()())},styles:[".main[_ngcontent-%COMP%]{width:100%;height:100%;background-color:green}"]}),t})()}];let O=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[M.ez,w.Bz.forChild(D),I.g0,E.ot,b,S.p0,R.TU,T.ZX,p.u5,p.UX]}),t})()}}]);